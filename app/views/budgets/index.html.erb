<h1><%= @budget.title %></h1>


<table class="table table-striped" id="budget">
    <thead>

        <tr>
            <th>&nbsp;</th>
            <% @periods.each do |period|  %>
                <th style="text-align: center;"><%= period.start_date.strftime("%m/%d") %></th>
            <% end %>
        </tr>
		<tr id="starting_balance">
            <th>Starting Balance</th>
            <% @periods.each do |period|  %>
               <td id="balance_<%= period.id %>" class="<%= period.beginning_balance < 0 ? 'negative-balance': ''%>"><%= number_to_currency(period.beginning_balance) %></td>
            <% end %>
        </tr>        
		<tr>
            <th style="color: #ffffff; background-color: #333333;">Income</th>
            <td colspan="<%= @periods.length %>" style="background-color: #333333;"> &nbsp;</td>
        </tr>

    </thead>

    <tbody>

    <%= render :partial => "income" %>
	<%= render :partial => "fixed_expenses" %>
	<%= render :partial => "fixed_expenses_aw" %>
	<%= render :partial => "variable_expenses" %>
	
    </tbody>

	<tfoot>
	<th style="color: #ffffff; background-color: #333333;">Remaining Balance</th>
	<% @periods.each do |period|  %>
		<td id="remaining_balance_<%= period.id %>" style="color: #ffffff; background-color: #333333;" nowrap><%= number_to_currency(period.ending_balance) %></td>
	<% end %>
	</tfoot>
</table>

<div id="expenseModal"class="modal" style="display: none;">
    <div class="modal-header">
      <a href="" class="close" data-dismiss="modal">x</a>
      <h3>Add Expense</h3>
    </div>
    <div class="modal-body">Loading..</div>
    <div class="modal-footer">
      <a href="#" class="btn btn-primary">Save</a>
      <a href="#" class="btn">Cancel</a>
    </div>
</div>

<div id="incomeModal" class="modal fade" style="display: none;"></div>

<script>
  $("#expenseModal").modal({"show": false});
  
  <% if @budget.incomes.length <= 2 %>
  	$("#incomeModal").modal({keyboard: false, backdrop: 'static', title: "Add Income"});
  	$("#incomeModal").load('/incomes/new?welcome=1');
  <% end %>

</script>
